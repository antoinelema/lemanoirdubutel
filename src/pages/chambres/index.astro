---
import Layout from '../../layouts/Layout.astro';
import Hero from '../../components/Hero.astro';
import BookingCTA from '../../components/BookingCTA.astro';
import { Image } from 'astro:assets';
import { getCollection } from 'astro:content';

import heroImage from '../../assets/images/exterior/charretterie.jpg';
import salonImage from '../../assets/images/common/salon-commun.jpg';
import petitDejImage from '../../assets/images/common/petit-dejeuner.jpg';

import charlyImage from '../../assets/images/rooms/charly/charly-preview.jpg';
import mathieuImage from '../../assets/images/rooms/mathieu/mathieu-preview.jpg';
import natureImage from '../../assets/images/rooms/nature/nature-preview.jpg';

const chambres = await getCollection('chambres');
const sorted = chambres.sort((a, b) => a.data.order - b.data.order);

const roomImages: Record<string, ImageMetadata> = {
  charly: charlyImage,
  mathieu: mathieuImage,
  nature: natureImage,
};
---

<Layout
  title="Nos Chambres — Le Manoir du Butel"
  description="Découvrez nos 3 chambres d'hôtes de charme au Manoir du Butel : Charly, Mathieu et Nature. Confort moderne dans un cadre historique en Normandie."
>

  <Hero
    title="Nos Chambres"
    subtitle="Trois chambres de charme, chacune avec sa personnalité"
    image={heroImage}
    imageAlt="La charretterie du Manoir du Butel"
    height="large"
  />

  <!-- Liste des chambres -->
  <section class="section-padding bg-offwhite">
    <div class="container mx-auto">
      {sorted.map((chambre, index) => (
        <div class={`grid grid-cols-1 lg:grid-cols-2 gap-10 lg:gap-16 items-center ${index > 0 ? 'mt-16 pt-16 border-t border-stone/30' : ''}`}>
          <div class={index % 2 === 1 ? 'lg:order-2' : ''}>
            <a href={`/chambres/${chambre.id}`} class="block relative overflow-hidden rounded-lg aspect-[4/3] group">
              <Image
                src={roomImages[chambre.id]}
                alt={`Chambre ${chambre.data.title}`}
                class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-105"
                widths={[400, 700]}
                sizes="(max-width: 1024px) 100vw, 50vw"
              />
              <div class="absolute top-4 left-4 bg-moss text-offwhite text-sm px-3 py-1 rounded-full font-heading">
                {chambre.data.type}
              </div>
            </a>
          </div>
          <div>
            <h2 class="text-2xl md:text-3xl mb-2">{chambre.data.title}</h2>
            <div class="separator !mx-0 mb-4"></div>
            <div class="flex flex-wrap gap-4 text-sm text-brown-light mb-4">
              <span class="flex items-center gap-1.5">
                <svg class="w-4 h-4 text-moss" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                  <path d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                </svg>
                {chambre.data.capacity}
              </span>
              <span class="flex items-center gap-1.5">
                <svg class="w-4 h-4 text-moss" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                  <path d="M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4" />
                </svg>
                {chambre.data.surface}
              </span>
              <span class="flex items-center gap-1.5">
                <svg class="w-4 h-4 text-moss" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                  <path d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z" />
                </svg>
                {chambre.data.bedType}
              </span>
            </div>
            <p class="text-brown-light leading-relaxed mb-6">{chambre.data.description}</p>
            <div class="flex flex-wrap gap-2 mb-6">
              {chambre.data.equipments.slice(0, 5).map((eq) => (
                <span class="text-xs bg-sand px-3 py-1.5 rounded-full text-brown-light">{eq}</span>
              ))}
            </div>
            <div class="flex flex-wrap gap-4">
              <a href={`/chambres/${chambre.id}`} class="btn-secondary">Voir les détails</a>
              <a
                href="/reserver"
                class="btn-gold"
              >
                Réserver — {chambre.data.price}
              </a>
            </div>
          </div>
        </div>
      ))}
    </div>
  </section>

  <!-- Espaces communs -->
  <section class="section-padding bg-parchment">
    <div class="container mx-auto">
      <div class="text-center mb-12">
        <h2>Espaces communs</h2>
        <div class="separator mb-4"></div>
        <p class="text-brown-light max-w-2xl mx-auto">
          Un salon privatif et un petit-déjeuner fait maison pour compléter votre séjour
        </p>
      </div>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
        <div class="card overflow-hidden">
          <div class="aspect-[16/10] overflow-hidden">
            <Image
              src={salonImage}
              alt="Salon commun privatif des chambres d'hôtes"
              class="w-full h-full object-cover"
              widths={[400, 600]}
              sizes="(max-width: 768px) 100vw, 50vw"
            />
          </div>
          <div class="p-6">
            <h3 class="text-xl mb-2">Salon privatif</h3>
            <p class="text-sm text-brown-light leading-relaxed">
              Un salon commun aux 3 chambres, équipé d'une télévision, d'une bouilloire
              avec thé et café, et d'un réfrigérateur. Un espace convivial pour se détendre
              après une journée de visite.
            </p>
          </div>
        </div>
        <div class="card overflow-hidden">
          <div class="aspect-[16/10] overflow-hidden">
            <Image
              src={petitDejImage}
              alt="Petit-déjeuner fait maison au Manoir du Butel"
              class="w-full h-full object-cover"
              widths={[400, 600]}
              sizes="(max-width: 768px) 100vw, 50vw"
            />
          </div>
          <div class="p-6">
            <h3 class="text-xl mb-2">Petit-déjeuner fait maison</h3>
            <p class="text-sm text-brown-light leading-relaxed">
              Chaque matin, un copieux petit-déjeuner vous attend dans la salle à manger
              du manoir. Produits locaux, confitures maison, viennoiseries fraîches et
              spécialités normandes. Inclus dans le tarif de la chambre.
            </p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <BookingCTA />

</Layout>
